name: Node

on:
    push:
        branches: [develop]
    pull_request:
        branches: [develop]

jobs:
    ci-cd:
        runs-on: ubuntu-latest
        strategy:
            matrix:
                version: [16^]
        steps:
            - uses: actions/checkout@v3
            - uses: actions/setup-node@v3
              with:
                  node-version: 16
                  cache: "npm"

            - name: Build-DB
              run: docker-compose build
            
            - name: Stop docker
              run: docker-compose stop
              
            - name: Run docker
              run: docker-compose up -d && cd tests && pwd && npm install && npm run test
              
            #- name: Run Tests
              #working-directory: ./tests
              #run: npm install && npm run test

    # build:
    #     needs: test
    #     runs-on: ubuntu-latest
    #     steps:
    #         - uses: actions/checkout@v3
    #         - name: Build
    #           run: go build -v main.go
